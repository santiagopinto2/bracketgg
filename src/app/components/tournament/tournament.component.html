<div class="no-select" [style.cursor]="isGrabbing ? 'grabbing' : 'grab'">
    <div class="container-fluid">
        <div class="row" *ngIf="phases.length > 1" style="margin-bottom: 30px">
            <div class="col-auto" *ngIf="currentPhaseIndex > 0">
                <button mat-icon-button (click)="changePhase(-1)">
                    <mat-icon fontIcon="arrow_back"></mat-icon>
                </button>
            </div>

            <div class="col-auto">
                <p style="font-size: large; font-weight: bold; margin-top: 14px">
                    {{phases[currentPhaseIndex].name}}</p>
            </div>

            <div class="col-auto" *ngIf="currentPhaseIndex < phases.length - 1">
                <button mat-icon-button (click)="changePhase(1)">
                    <mat-icon fontIcon="arrow_forward"></mat-icon>
                </button>
            </div>
        </div>

        <div class="row" *ngFor="let phaseGroup of phaseGroups; let i = index let lastPhaseGroup = last">
            <div class="col-12">
                <p *ngIf="phaseGroups.length > 1" style="font-size: 18px; margin-bottom: 0;">
                    Pool {{phaseGroup ? phaseGroup.displayIdentifier : ''}}
                </p>
            </div>

            <div class="col-12">
                <div class="row" *ngFor="let maxR of maxRounds[i]; let side = index" style="margin-top: 20px;">
                    <div class="row flex-nowrap" id="full-round-text-row">
                        <div class="col p-0 d-flex justify-content-center round" *ngFor="let _ of [].constructor(maxRounds[i][side]); let j = index" style="width: 204px; margin-right: 44px;"
                            id="full-round-text-column">
                            <p class="full-round-text">{{phaseGroup ?
                                getRoundSets(phaseGroup, (j
                                + 1) * maxRoundModifier[side])[0].fullRoundText : ''}}</p>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="row flex-nowrap" [ngStyle]="{'height': getPhaseGroupSideHeight(phaseGroup, side) + 'px'}">
                            <div class="col px-0" [ngStyle]="{'max-width': getColumnWidth(j)}" *ngFor="let _ of [].constructor((maxRounds[i][side]) * 3 - 2); let j = index" id="set-block-column-container">
                                <div *ngIf="j % 3 == 0" class="d-flex flex-column round" id="set-column">
                                    <div class="row set" *ngFor="let set of getRoundSets(phaseGroup, (j / 3 + 1) * maxRoundModifier[side])" id="set"
                                        [ngStyle]="{'margin': getSetMargin(phaseGroup, (j / 3 + 1) * maxRoundModifier[side], side, set)}">
                                        <div class="col p-0" id="names">
                                            <div class="row set-row" *ngFor="let slot of set.slots" [ngClass]="isWinner(set, slot, 'name')">
                                                <div class="set-name">
                                                    {{slot.entrant ? slot.entrant.name : 'â€Ž'}}
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col p-0" style="max-width: 20px; border-left: 1px white solid;" id="scores">
                                            <div class="row set-row" *ngFor="let slot of set.slots" [ngClass]="isWinner(set, slot, 'score')">
                                                <div class="d-flex justify-content-center p-0">
                                                    {{getScore(slot, set)}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="j % 3 != 0" class="d-flex flex-column justify-content-around" style="height: 100%; width: 22px" id="block-column">
                                    <div class="row"
                                        *ngFor="let _ of [].constructor(getRoundSets(phaseGroup, (j / 3 + 2) * maxRoundModifier[side]).length * 4); let blockIndex = index; let blockCount = count"
                                        id="block-container">
                                        <div style="padding: 0 11px" [ngStyle]="{'height': getPhaseGroupSideHeight(phaseGroup, side) / blockCount + 'px'}" [ngClass]="getBlockClass(j, blockIndex, phaseGroup, side)"
                                            id="block">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <hr *ngIf="!lastPhaseGroup" style="margin-top: 50px; border-top: solid 10px">
        </div>
    </div>
</div>